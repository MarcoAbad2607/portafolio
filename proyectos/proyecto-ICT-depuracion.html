<!doctype html>
<html lang="es" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ICT ‚Äî Mejora de CPK (capacitor en paralelo)</title>
  <meta name="description" content="Caso completo: mejora de CPK en ICT i3070 ajustando nominal y par√°metros de prueba tras identificar dos capacitores en paralelo (2.2 ¬µF + 2.2 ¬µF ‚Üí 4.4 ¬µF)." />
  <meta name="theme-color" content="#f8fafc" id="themeColor">
  <link rel="icon" href="../img/favicon.ico">
  <style>
    /* =========== Paleta base =========== */
    :root{
      --bg:#f8fafc; --panel:#ffffff; --ink:#0b1220; --muted:#475569; --line:#cbd5e1;
      --acc:#22d3ee; --acc-2:#a78bfa; --warn:#f59e0b; --ok:#34d399;
      --btn-copy-bg:#0f172a; --btn-copy-ink:#e6edf3; --code-bg:#0b1220; --code-ink:#e6edf3;
      --chip-bg:#eef2ff; --chip-ink:#1e293b;
    }
    html[data-theme="dark"]{
      --bg:#0b1220; --panel:#0f172a; --ink:#e6edf3; --muted:#98a2b3; --line:#22314c;
      --btn-copy-bg:#1f2937; --btn-copy-ink:#e5e7eb; --code-bg:#0a0f1a; --code-ink:#e6edf3;
      --chip-bg:#111827; --chip-ink:#e5e7eb;
    }

    *{box-sizing:border-box}
    html{height:100%;scroll-behavior:smooth}
    body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:var(--bg);color:var(--ink)}
    a{color:var(--acc);text-decoration:none} a:hover{text-decoration:underline}
    img{max-width:100%;display:block}
    .wrap{max-width:1200px;margin:0 auto;padding:0 20px}

    /* Header */
    header{position:sticky;top:0;z-index:50;background:rgba(248,250,252,.7);backdrop-filter:blur(10px);border-bottom:1px solid var(--line)}
    html[data-theme="dark"] header{ background:rgba(11,18,32,.6); }
    nav{display:flex;align-items:center;justify-content:space-between;height:64px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.3px}
    .brand .dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(90deg,var(--acc),var(--acc-2))}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;background:var(--acc);color:#05131e;font-weight:700;border:none;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid var(--line);color:var(--ink)}
    .mode{background:transparent;border:1px solid var(--line);color:var(--ink);padding:6px 10px;border-radius:10px;margin-left:8px;cursor:pointer}

    /* Chips */
    .chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--line);background:var(--chip-bg);color:var(--chip-ink);font-size:12.5px}

    /* Hero */
    .hero{position:relative;overflow:hidden}
    .hero .inner{display:grid;gap:24px;grid-template-columns:1.1fr .9fr;align-items:center;padding:36px 0 12px}
    .title{font-size:clamp(28px,4.5vw,48px);line-height:1.1;margin:0}
    .lead{color:var(--muted);margin:0}
    .cta{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
    .blob{position:absolute;inset:-20% auto auto -10%;width:60vw;height:60vw;filter:blur(80px);background:
      radial-gradient(circle at 30% 30%,rgba(34,211,238,.25),transparent 60%),
      radial-gradient(circle at 70% 60%,rgba(167,139,250,.22),transparent 60%);pointer-events:none}
    .avatar{width:140px;height:140px;border-radius:12px;border:2px solid var(--line);background:#0b1220;margin-left:auto;object-fit:cover}

    /* Secciones */
    section{padding:28px 0;scroll-margin-top:80px}
    h2{font-size:22px;margin:0 0 12px}
    .muted{color:var(--muted)}
    .panel{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:16px}
    .grid{display:grid;gap:16px}
    .cards{grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;overflow:hidden;position:relative}

    /* Galer√≠a (contain) */
    .thumb{width:100%;height:clamp(200px, 28vw, 320px);display:grid;place-items:center;background:linear-gradient(180deg, rgba(0,0,0,.02), rgba(0,0,0,.04))}
    html[data-theme="dark"] .thumb{ background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.06)); }
    .thumb img{width:100%;height:100%;object-fit:contain;object-position:center}
    .view-full{position:absolute;right:10px;bottom:10px;padding:6px 10px;font-size:12.5px;border-radius:10px;border:1px solid var(--line);background:rgba(15,23,42,.65);color:#fff;backdrop-filter:blur(4px);display:inline-flex;gap:6px;align-items:center;opacity:0;transform:translateY(4px);transition:.2s ease;cursor:pointer}
    .card:hover .view-full{opacity:1;transform:none}

    /* Breadcrumb */
    .crumbs{display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin:12px 0}
    .crumbs a, .crumbs span[aria-current="page"]{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:999px;border:1px solid var(--line);background:var(--chip-bg);color:var(--chip-ink);text-decoration:none}
    .crumbs .sep{opacity:.5;color:var(--muted);padding:0 2px}

    /* C√≥digo */
    pre{position:relative;margin:0;padding:14px;border:1px solid var(--line);background:var(--code-bg);border-radius:12px;overflow:auto;padding-top:38px}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;color:var(--code-ink);font-size:13.5px;white-space:pre}
    .copy{position:absolute;right:8px;top:8px;padding:7px 10px;border-radius:8px;border:1px solid var(--line);background:var(--btn-copy-bg);color:var(--btn-copy-ink);cursor:pointer;font-size:12px;box-shadow:0 1px 2px rgba(0,0,0,.25)}

    /* Procedimiento */
    .steps{display:grid;grid-template-columns:1fr;gap:16px;width:100%;margin:0;box-sizing:border-box}
    .step{position:relative;background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:16px;box-sizing:border-box;overflow:hidden}
    .step::before{content:attr(data-step);position:absolute;left:16px;top:16px;width:28px;height:28px;border-radius:999px;display:grid;place-items:center;font-weight:700;background:linear-gradient(90deg,var(--acc),var(--acc-2));color:#05131e}
    .step h3{margin:0 0 8px 44px}

    /* Footer & toTop */
    footer{padding:28px 0 48px;color:var(--muted);border-top:1px solid var(--line)}
    #toTop{position:fixed;right:16px;bottom:16px;display:none;align-items:center;gap:6px;padding:10px 12px;border-radius:999px;border:1px solid var(--line);background:rgba(15,23,42,.75);color:#fff}

    /* Lightbox */
    dialog#lightbox{border:none;padding:0;margin:0;width:min(96vw,1200px);max-width:96vw;background:transparent}
    dialog#lightbox::backdrop{background:rgba(0,0,0,.65);backdrop-filter:blur(2px)}
    .lb-wrap{position:relative;background:var(--panel);border:1px solid var(--line);border-radius:14px;overflow:hidden}
    .lb-toolbar{position:absolute;top:8px;right:8px;display:flex;gap:8px}
    .lb-btn{background:rgba(15,23,42,.8);color:#fff;border:1px solid var(--line);border-radius:10px;padding:8px 10px;font-size:13px;cursor:pointer}
    .lb-img{width:100%;height:80vh;max-height:80vh;object-fit:contain;background:#000}
    .lb-caption{padding:10px 12px;font-size:13px;color:var(--muted);border-top:1px solid var(--line);background:var(--panel)}

    /* Responsive */
    @media (max-width: 900px){.hero .inner{grid-template-columns: 1fr; padding:24px 0 8px;} .avatar{margin:12px auto 0} .cards{grid-template-columns:1fr} .steps{gap:12px} .step{padding:12px} .step::before{top:12px; left:12px; width:26px; height:26px;} .step h3{margin:0 0 8px 44px} pre{padding:10px;border-radius:8px} code{font-size:12.5px;white-space:pre-wrap;word-break:break-word} .copy{padding:6px 9px; font-size:12px; right:6px; top:6px} }
    @media (max-width: 380px){ .step{ padding-left:12px;} .step::before{ width:24px; height:24px; font-size:13px;} code{ font-size:12px;} }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="wrap">
      <nav>
        <div class="brand"><span class="dot"></span> <span>Marco A. Mu√±iz ‚Äî Proyecto</span></div>
        <div style="display:flex;align-items:center;gap:8px">
          <a class="btn ghost" href="../index.html#proyectos">‚Üê Volver</a>
          <button id="mode" class="mode" aria-label="Tema">‚òº</button>
        </div>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <div class="hero">
    <div class="blob" aria-hidden="true"></div>
    <div class="wrap inner">
      <div>
        <span class="chip">Proyecto</span>
        <h1 class="title">ICT ‚Äî Mejora de CPK (C en paralelo)</h1>
        <p class="lead">Depuraci√≥n de prueba de <strong>capacitor</strong> en i3070: identificaci√≥n de dos capacitores en <strong>paralelo</strong> (2.2 ¬µF + 2.2 ¬µF ‚Üí 4.4 ¬µF), ajuste de nominal y par√°metros, y <strong>CPK</strong> de ‚àí0.9022 a <strong>24.1</strong>.</p>
        <div class="cta">
          <a class="btn" href="../index.html#proyectos">‚Üê Volver</a>
          <a class="btn ghost" href="#procedimiento">Ver procedimiento</a>
        </div>
      </div>
      <div>
        <img class="avatar" loading="lazy" decoding="async" alt="ICT Mejora de CPK" src="../img/ICT-depuracion-main.png" />
      </div>
    </div>
  </div>

  <!-- Aviso + Breadcrumb -->
  <div class="wrap" style="margin-top:10px">
    <div class="panel" style="margin-bottom:20px; border-left:4px solid var(--warn); background:rgba(245,158,11,.08)">
      <p style="margin:0; font-size:14.5px; line-height:1.5; color:var(--muted)">üîí <strong>Aviso:</strong> Parte de la informaci√≥n t√©cnica y de negocio ha sido <u>omitida</u> por motivos de confidencialidad y derechos de propiedad intelectual.</p>
    </div>
    <nav class="crumbs" aria-label="breadcrumb">
      <a href="../index.html">Inicio</a>
      <span class="sep">‚Ä∫</span>
      <a href="../index.html#proyectos">Proyectos</a>
      <span class="sep">‚Ä∫</span>
      <span aria-current="page">ICT ‚Äî Mejora de CPK</span>
    </nav>
  </div>

  <!-- Contenido principal -->
  <main class="wrap">
    <!-- Resumen -->
    <section>
      <h2>Resumen</h2>
      <div class="panel">
        <p>
          Una prueba de capacitor en <strong>ICT i3070</strong> presentaba <em>CPK negativo</em> debido a que el nominal se consideraba 2.2 ¬µF cuando en realidad el circuito ten√≠a <strong>dos capacitores de 2.2 ¬µF en paralelo</strong>. 
          Tras validar el esquem√°tico y ajustar el test plan (nominal, frecuencia, repeticiones y <em>remote sense</em>), el <strong>CPK</strong> mejor√≥ a <strong>24.1</strong>.
        </p>
        <div class="row" style="margin-top:8px">
          <span class="tag">Keysight i3070</span>
          <span class="tag">CPK / Capacidad</span>
          <span class="tag">Paralelo de capacitores</span>
          <span class="tag">Prueba anal√≥gica</span>
        </div>
      </div>
    </section>

    <!-- Procedimiento realizado -->
    <section id="procedimiento">
      <h2>Procedimiento realizado</h2>
      <div class="steps">
        <!-- Paso 1 -->
        <article class="step" data-step="1">
          <h3>S√≠ntoma: CPK bajo en medici√≥n de C</h3>
          <p class="muted">Con la configuraci√≥n original, el CPK era <strong>‚àí0.9022</strong>. Se inspeccion√≥ el <em>histograma</em> y los l√≠mites.</p>
          <pre><button class="copy" data-copy>Copiar</button><code>! Fragmento (antes)
disconnect all
connect s to "GND"
connect i to "NetC259_1"
connect g to "+3V3"; l to "+3V3"

capacitor 2.2u, 25, 25, fr1024, re2, ar200.0m, en, nocomp
! DUT: nominal 2.2u, plus tol 10.0 %, minus tol 10.0 %
! TEST: high limit 2.438u, low limit 1.962u
! CPK ‚âà -0.9022</code></pre>
        </article>

        <!-- Paso 2 -->
        <article class="step" data-step="2">
          <h3>Hallazgo en esquem√°tico</h3>
          <p class="muted">Se detect√≥ que el punto de prueba corresponde a <strong>dos capacitores de 2.2 ¬µF en paralelo</strong> ‚Üí nominal real <strong>4.4 ¬µF</strong>.</p>
          <ul>
            <li>Validaci√≥n contra BOM y variante poblada.</li>
            <li>Revisi√≥n de paths hacia alimentaci√≥n para evitar sesgos de medici√≥n.</li>
          </ul>
        </article>

        <!-- Paso 3 -->
        <article class="step" data-step="3">
          <h3>Ajuste de nominal y par√°metros</h3>
          <p class="muted">Se actualiz√≥ el <em>nominal</em>, se activ√≥ <em>remote sense</em> (<code>sa/sb</code>) y se ajustaron <em>frecuencia</em> y <em>repeticiones</em>.</p>
          <pre><button class="copy" data-copy>Copiar</button><code>! Fragmento (despu√©s)
disconnect all
connect s to "GND"; a to "GND"
connect i to "NetC259_1"; b to "NetC259_1"
connect g to "+3V3"; l to "+3V3"

capacitor 4.4u, 24, 4, fr128, re4, ar200.0m, sa, sb, en, nocomp, ed
! DUT: nominal 4.4u, plus tol 10.0 %, minus tol 10.0 %
! TEST: high limit 4.84u, low limit 3.96u</code></pre>
          <ul>
            <li><code>4.4u</code> = 2.2 ¬µF + 2.2 ¬µF en paralelo.</li>
            <li><code>sa, sb</code>: medici√≥n Kelvin/remote sense para reducir ca√≠da en leads/fixture.</li>
            <li><code>fr128</code>: frecuencia m√°s adecuada para estabilidad en C.</li>
            <li><code>re4</code>: m√°s repeticiones ‚Üí mejor estad√≠stica.</li>
          </ul>
        </article>

        <!-- Paso 4 -->
        <article class="step" data-step="4">
          <h3>Resultado</h3>
          <p class="muted">La distribuci√≥n qued√≥ centrada dentro de los l√≠mites; el <strong>CPK</strong> subi√≥ a <strong>24.1</strong>.</p>
          <pre><button class="copy" data-copy>Copiar</button><code>// F√≥rmula usada para auditor√≠a:
Cpk = min( (USL - Œº) / (3œÉ), (Œº - LSL) / (3œÉ) )</code></pre>
          <p class="muted" style="margin-top:8px">Nota: si no se regeneran comentarios, es posible que el texto informativo en el IPG siga mostrando 2.2 ¬µF; lo efectivo es el valor del comando <code>capacitor 4.4u</code>.</p>
        </article>
      </div>
    </section>

    <!-- Galer√≠a -->
    <section>
      <h2>Galer√≠a</h2>
      <div class="grid cards" id="galeria">
        <div class="card">
          <div class="thumb"><img loading="lazy" decoding="async" src="../img/ict-cpk-antes.png" alt="CPK antes: -0.9022"></div>
          <button class="view-full" data-full="../img/ict-cpk-antes.png">üîé Ver completa</button>
        </div>
        <div class="card">
          <div class="thumb"><img loading="lazy" decoding="async" src="../img/ict-cpk-esquematico.png" alt="Esquem√°tico: dos capacitores en paralelo"></div>
          <button class="view-full" data-full="../img/ict-cpk-esquematico.png">üîé Ver completa</button>
        </div>
        <div class="card">
          <div class="thumb"><img loading="lazy" decoding="async" src="../img/ict-cpk-despues.png" alt="CPK despu√©s: 24.1"></div>
          <button class="view-full" data-full="../img/ict-cpk-despues.png">üîé Ver completa</button>
        </div>
      </div>
    </section>

    <!-- Detalles t√©cnicos -->
    <section>
      <h2>Detalles t√©cnicos</h2>
      <div class="panel">
        <ul>
          <li><strong>Tipo de prueba:</strong> medici√≥n de capacidad en ICT (anal√≥gica).</li>
          <li><strong>Hallazgo:</strong> dos capacitores de 2.2 ¬µF en paralelo ‚Üí nominal efectivo 4.4 ¬µF.</li>
          <li><strong>Ajustes clave:</strong> <code>capacitor 4.4u</code>, <code>sa/sb</code> (Kelvin), <code>fr128</code> (frecuencia), <code>re4</code> (repeticiones).</li>
          <li><strong>L√≠mites:</strong> ¬±10 % ‚Üí LSL 3.96 ¬µF, USL 4.84 ¬µF (ajustables seg√∫n pol√≠tica de guard band).</li>
          <li><strong>Buenas pr√°cticas:</strong> validar nominal en la <em>red real</em>, confirmar variante de BOM y revisar paths a alimentaci√≥n.</li>
        </ul>
      </div>
    </section>

    <!-- Resultados -->
    <section>
      <h2>Resultados</h2>
      <div class="panel">
        <ul>
          <li><strong>CPK:</strong> de <strong>‚àí0.9022</strong> a <strong>24.1</strong>.</li>
          <li><strong>Falsos rechazos ‚Üì</strong> y mayor estabilidad de medici√≥n.</li>
          <li><strong>Tiempo de an√°lisis ‚Üì</strong> y reparaci√≥n enfocada en la causa ra√≠z.</li>
        </ul>
      </div>
    </section>
  </main>

  <!-- toTop -->
  <div id="toTop">‚ñ≤ Arriba</div>

  <!-- Lightbox -->
  <dialog id="lightbox" aria-label="Visor de imagen completa">
    <div class="lb-wrap">
      <div class="lb-toolbar">
        <a class="lb-btn" id="lb-download" download>‚¨á Descargar</a>
        <button class="lb-btn" id="lb-close" aria-label="Cerrar">‚úï</button>
      </div>
      <img class="lb-img" id="lb-img" alt="">
      <div class="lb-caption" id="lb-caption"></div>
    </div>
  </dialog>

  <!-- Footer -->
  <footer>
    <div class="wrap">¬© <span id="year"></span> Marco Antonio Mu√±iz Abad ¬∑ Hecho con HTML/CSS/JS ¬∑ Publicado en GitHub Pages</div>
  </footer>

  <script>
    // A√±o din√°mico
    document.getElementById('year').textContent = new Date().getFullYear();

    // Tema claro/oscuro
    const modeBtn = document.getElementById('mode');
    const themeMeta = document.getElementById('themeColor');
    function applyTheme(isDark){
      document.documentElement.dataset.theme = isDark ? 'dark' : 'light';
      if (modeBtn) modeBtn.textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
      if (themeMeta) themeMeta.setAttribute('content', isDark ? '#0b1220' : '#f8fafc');
    }
    (function initTheme(){
      const saved = localStorage.getItem('theme');
      const isDark = saved ? (saved === 'dark') : false;
      applyTheme(isDark);
    })();
    if (modeBtn){
      modeBtn.addEventListener('click', ()=>{
        const nowDark = (document.documentElement.dataset.theme !== 'dark');
        applyTheme(nowDark);
        localStorage.setItem('theme', nowDark ? 'dark' : 'light');
      });
    }

    // Copiar c√≥digo
    document.querySelectorAll('[data-copy]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const code = btn.nextElementSibling?.innerText || '';
        navigator.clipboard.writeText(code).then(()=>{
          const old = btn.textContent; btn.textContent = '¬°Copiado!'; setTimeout(()=> btn.textContent = old, 1200);
        });
      });
    });

    // To top
    const toTop = document.getElementById('toTop');
    window.addEventListener('scroll', ()=>{ toTop.style.display = window.scrollY > 500 ? 'inline-flex' : 'none'; });
    toTop.addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));

    // Lightbox galer√≠a
    const lightbox = document.getElementById('lightbox');
    const lbImg = document.getElementById('lb-img');
    const lbCaption = document.getElementById('lb-caption');
    const lbClose = document.getElementById('lb-close');
    const lbDownload = document.getElementById('lb-download');

    function openLightbox(src, alt){
      lbImg.src = src; lbImg.alt = alt || ''; lbCaption.textContent = alt || '';
      lbDownload.href = src; lbDownload.setAttribute('download', (alt || 'imagen') + '.png');
      if (typeof lightbox.showModal === 'function') lightbox.showModal(); else lightbox.setAttribute('open','');
    }
    function closeLightbox(){ if (typeof lightbox.close === 'function') lightbox.close(); else lightbox.removeAttribute('open'); lbImg.src = ''; }

    document.getElementById('galeria').addEventListener('click', (e)=>{
      const card = e.target.closest('.card'); if (!card) return;
      const img = card.querySelector('.thumb img'); const btn = e.target.closest('.view-full');
      if (img && (e.target === img || btn)) { const src = btn?.dataset.full || img.currentSrc || img.src; openLightbox(src, img.alt || 'Imagen'); }
    });
    lbClose.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e)=>{ if (e.target === lightbox) closeLightbox(); });
    document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape' && lightbox.open) closeLightbox(); });
  </script>
</body>
</html>
